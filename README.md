### 简介
收集网络中在cobaltstrike中使用的bof工具集。主要收集零散项目，项目基于CS-Situational-Awareness-BOF推荐的创建方式和流程。代码均来之网络。
本项目中不包含CS-Situational-Awareness-BOF项目内容，此项目更新活跃，建议单独下载编译使用https://github.com/trustedsec/CS-Situational-Awareness-BOF。
结合本项目一起使用。

### 直接使用
```
git clone https://github.com/AttackTeamFamily/cobaltstrike-bof-toolset.git
使用CobaltStrike加载cobaltstrike-bof-toolset/bof.cna脚本
```

### 自己编译
```
编译环境：kali linux
命令：
sudo apt install mingw-x64
git clone https://github.com/AttackTeamFamily/cobaltstrike-bof-toolset.git
cd cobaltstrike-bof-toolset
cd src/bof
for i in `ls`;do cd $i && make && cd ..;done
```

### 功能
|命令|使用|说明|
|-------|-----|-----|
|domaininfo|domaininfo|获取当前域和域控信息|
|clipboard|clipboard|获取粘贴板中的文本|
|wifienum|wifienum|枚举wifi接口|
|wifiedump|wifiedump [Wifi_Profile_Name]|dump wifi明文凭据|
|etw|etw [stop\|start]|ETW Patching|
|read_function|read_function [module] [function1,function2]|read_function ntdll.dll NtCreateProcess,NtCreateFile|
|check_function|check_function [module] [function]|check_function ntdll.dll EtwEventWrite|
|patch_function|patch_function [dll_path] [function_name]|patch_function ntdll.dll EtwEventWrite|
|curl|curl host [port] [method] [--show] [useragent] [headers] [body] [--noproxy]|curl http://example.com 80 GET --show|

### 来源
|  Type   |   Name  |  Description   |  Popularity   |   Language  |
|:---:|:---:|:---:|:---:|:---:|
|  ALL   |   [BOF_Collection](https://github.com/rvrsh3ll/BOF_Collection)  |   Various Cobalt Strike BOFs  |  ![](https://img.shields.io/github/stars/rvrsh3ll/BOF_Collection)   | ![](https://img.shields.io/github/languages/top/rvrsh3ll/BOF_Collection)     |
|  ALL   |   [Situational Awareness BOF](https://github.com/trustedsec/CS-Situational-Awareness-BOF)  |   Its larger goal is providing a code example and workflow for others to begin making more BOF files. [Blog](https://www.trustedsec.com/blog/a-developers-introduction-to-beacon-object-files/)  |  ![](https://img.shields.io/github/stars/trustedsec/CS-Situational-Awareness-BOF)   | ![](https://img.shields.io/github/languages/top/trustedsec/CS-Situational-Awareness-BOF)     |
|  ALL   |   [bof_helper](https://github.com/dtmsecurity/bof_helper)  |   Beacon Object File (BOF) Creation Helper  |  ![](https://img.shields.io/github/stars/dtmsecurity/bof_helper)   | ![](https://img.shields.io/github/languages/top/dtmsecurity/bof_helper)     |
|  ALL   |   [BOF-DLL-Inject](https://github.com/tomcarver16/BOF-DLL-Inject)  |   BOF DLL Inject is a custom Beacon Object File that uses manual map DLL injection in order to migrate a dll into a process all from memory.  |  ![](https://img.shields.io/github/stars/tomcarver16/BOF-DLL-Inject)   | ![](https://img.shields.io/github/languages/top/tomcarver16/BOF-DLL-Inject)     |
|  ALL   |   [cobaltstrike_bofs](https://github.com/m57/cobaltstrike_bofs)  |   BOF spawns a process of your choice under a specified parent, and injects a provided shellcode file via QueueUserAPC().  |  ![](https://img.shields.io/github/stars/m57/cobaltstrike_bofs)   | ![](https://img.shields.io/github/languages/top/m57/cobaltstrike_bofs)     |
|  ALL   |   [BOF-RegSave](https://github.com/EncodeGroup/BOF-RegSave)  |   Beacon Object File(BOF) for CobaltStrike that will acquire the necessary privileges and dump SAM - SYSTEM - SECURITY registry keys for offline parsing and hash extraction.  |  ![](https://img.shields.io/github/stars/EncodeGroup/BOF-RegSave)   | ![](https://img.shields.io/github/languages/top/EncodeGroup/BOF-RegSave)     |
|  ALL   |   [CobaltStrike BOF](https://github.com/Yaxser/CobaltStrike-BOF)  |   DCOM Lateral Movement; WMI Lateral Movement - Win32_Process Create; WMI Lateral Movement - Event Subscription  |  ![](https://img.shields.io/github/stars/Yaxser/CobaltStrike-BOF)   | ![](https://img.shields.io/github/languages/top/Yaxser/CobaltStrike-BOF)     |
|  ALL   |   [BOFs](https://github.com/ajpc500/BOFs)  |   ETW Patching; API Function Utility; Syscalls Shellcode Injection  |  ![](https://img.shields.io/github/stars/ajpc500/BOFs)   | ![](https://img.shields.io/github/languages/top/ajpc500/BOFs)     |
|  Dev   |   [bof](https://github.com/nccgroup/nccfsas/blob/main/Tools/bof-vs-template/README.md)  |   This is a template project for building Cobalt Strike BOFs in Visual Studio.  |  ![](https://img.shields.io/github/stars/nccgroup/nccfsas)   | ![](https://img.shields.io/github/languages/top/nccgroup/nccfsas)     |
|  Dev   |   [Needle_Sift_BOF](https://github.com/EspressoCake/Needle_Sift_BOF)  |   Strstr with user-supplied needle and filename as a BOF.  |  ![](https://img.shields.io/github/stars/EspressoCake/Needle_Sift_BOF)   | ![](https://img.shields.io/github/languages/top/EspressoCake/Needle_Sift_BOF)     |
|  Dev   |   [BOF.NET](https://github.com/CCob/BOF.NET)  |   A .NET Runtime for Cobalt Strike's Beacon Object Files.  |  ![](https://img.shields.io/github/stars/CCob/BOF.NET)   | ![](https://img.shields.io/github/languages/top/CCob/BOF.NET)     |
|  Dev   |   [beacon-object-file](https://github.com/realoriginal/beacon-object-file)  |   The format, described by Mudge [here](https://youtube.com/watch?v=gfYswA_Ronw), asks that the operator construct an COFF file using a mingw-w64 compiler or the msvc compiler that holds an symbol name indicating its entrypoint, and underlying function calls.  |  ![](https://img.shields.io/github/stars/realoriginal/beacon-object-file)   | ![](https://img.shields.io/github/languages/top/realoriginal/beacon-object-file)     |
|  Dev   |   [InlineWhispers](https://github.com/outflanknl/InlineWhispers)  |   Demonstrate the ability to easily use syscalls using inline assembly in BOFs.  |  ![](https://img.shields.io/github/stars/outflanknl/InlineWhispers)   | ![](https://img.shields.io/github/languages/top/outflanknl/InlineWhispers)     |
|  Dev   |   [WdToggle](https://github.com/outflanknl/WdToggle)  |   A Proof of Concept Cobalt Strike Beacon Object File which uses direct system calls to enable WDigest credential caching and circumvent Credential Guard (if enabled).  |  ![](https://img.shields.io/github/stars/outflanknl/WdToggle)   | ![](https://img.shields.io/github/languages/top/outflanknl/WdToggle)     |
|  Dev   |   [Situational Awareness BOF](https://github.com/trustedsec/CS-Situational-Awareness-BOF)  |   This Repo intends to serve two purposes. First it provides a nice set of basic situational awareness commands implemented in BOF. This allows you to perform some checks on a host before you begin executing commands that may be more invasive.  |  ![](https://img.shields.io/github/stars/trustedsec/CS-Situational-Awareness-BOF)   | ![](https://img.shields.io/github/languages/top/trustedsec/CS-Situational-Awareness-BOF)     |
|  Dev   |   [MiniDumpWriteDump](https://github.com/rookuu/BOFs/tree/main/MiniDumpWriteDump)  |   Custom implementation of DbgHelp's MiniDumpWriteDump function. Uses static syscalls to replace low-level functions like NtReadVirtualMemory.  |  ![](https://img.shields.io/github/stars/rookuu/BOFs)   | ![](https://img.shields.io/github/languages/top/rookuu/BOFs)     |
|  Dev   |   [COFF Loader](https://github.com/trustedsec/COFFLoader)  |   This is a quick and dirty COFF loader (AKA Beacon Object Files). Currently can run un-modified BOF's so it can be used for testing without a CS agent running it. The only exception is that the injection related beacon compatibility functions are just empty.  |  ![](https://img.shields.io/github/stars/trustedsec/COFFLoader)   | ![](https://img.shields.io/github/languages/top/trustedsec/COFFLoader)     |
|  Dev   |   [Self_Deletion_BOF](https://github.com/EspressoCake/Self_Deletion_BOF)  |   BOF implementation of the research by @jonasLyk and the drafted PoC from @LloydLabs  |  ![](https://img.shields.io/github/stars/EspressoCake/Self_Deletion_BOF)   | ![](https://img.shields.io/github/languages/top/EspressoCake/Self_Deletion_BOF)     |
|  Auxiliary   |   [EnumCLR.c](https://gist.github.com/G0ldenGunSec/8ca0e853dd5637af2881697f8de6aecc)  |   Cobalt Strike BOF to identify processes with the CLR loaded with a goal of identifying SpawnTo / injection candidates.  |  ![](https://img.shields.io/github/stars/G0ldenGunSec)   | ![](https://img.shields.io/github/languages/top/G0ldenGunSec)     |
|  Auxiliary   |   [FindObjects-BOF](https://github.com/outflanknl/FindObjects-BOF)  |   A Cobalt Strike Beacon Object File (BOF) project which uses direct system calls to enumerate processes for specific modules or process handles.  |  ![](https://img.shields.io/github/stars/outflanknl/FindObjects-BOF)   | ![](https://img.shields.io/github/languages/top/outflanknl/FindObjects-BOF)     |
|  Auxiliary   |   [GetWebDAVStatus](https://github.com/G0ldenGunSec/GetWebDAVStatus)  |   Small project to determine if the Web Client service (WebDAV) is running on a remote system by checking for the presence of the DAV RPC SERVICE named pipe.   |  ![](https://img.shields.io/github/stars/G0ldenGunSec/GetWebDAVStatus)   | ![](https://img.shields.io/github/languages/top/G0ldenGunSec/GetWebDAVStatus)     |
|  Auxiliary   |   [ChromeKeyDump](https://github.com/crypt0p3g/bof-collection/tree/main/ChromeKeyDump)  |   BOF implementation of Chlonium tool to dump Chrome Masterkey and download Cookie/Login Data files  |  ![](https://img.shields.io/github/stars/crypt0p3g/bof-collection)   | ![](https://img.shields.io/github/languages/top/crypt0p3g/bof-collection)     |
|  Auxiliary   |   [Sleeper](https://github.com/crypt0p3g/bof-collection/tree/main/Sleeper)  |   BOF to call the SetThreadExecutionState function to prevent host from Sleeping  |  ![](https://img.shields.io/github/stars/crypt0p3g/bof-collection)   | ![](https://img.shields.io/github/languages/top/crypt0p3g/bof-collection)     |
|  Auxiliary   |   [LSASS](https://github.com/pwn1sher/CS-BOFs/tree/main/lsass)  |   Beacon Object File to dump Lsass memory by obtaining a snapshot handle. Does MiniDumpWriteDump/NtReadVirtualMemory on SnapShot of LSASS instad of original LSASS itself hence evades some AV/EDR.  |  ![](https://img.shields.io/github/stars/pwn1sher/CS-BOFs)   | ![](https://img.shields.io/github/languages/top/pwn1sher/CS-BOFs)     |
|  Auxiliary   |   [getsystem](https://github.com/pwn1sher/CS-BOFs/tree/main/get-system)  |   get system by duplicating winlogon's token.  |  ![](https://img.shields.io/github/stars/pwn1sher/CS-BOFs)   | ![](https://img.shields.io/github/languages/top/pwn1sher/CS-BOFs)     |
|  Auxiliary   |   [Silent Lsass Dump](https://github.com/Cobalt-Strike/unhook-bof)  |   Silent Lsass Dump  |  ![](https://img.shields.io/github/stars/guervild/BOFs)   | ![](https://img.shields.io/github/languages/top/guervild/BOFs)     |
|  Auxiliary   |   [unhook-bof](https://github.com/guervild/BOFs)  |   This is a Beacon Object File to refresh DLLs and remove their hooks.   |  ![](https://img.shields.io/github/stars/Cobalt-Strike/unhook-bof)   | ![](https://img.shields.io/github/languages/top/Cobalt-Strike/unhook-bof)     |
|  Auxiliary   |   [Beacon Health Check Aggressor Script](https://github.com/Cobalt-Strike/beacon_health_check)  |   This aggressor script uses a beacon's note field to indicate the health status of a beacon.    |  ![](https://img.shields.io/github/stars/Cobalt-Strike/beacon_health_check)   | ![](https://img.shields.io/github/languages/top/Cobalt-Strike/beacon_health_check)     |
|  Auxiliary   |   [Registry BOF](https://github.com/lpBunny/bof-registry)  |   A beacon object file for use with cobalt strike v4.1+. Supports querying, adding, and deleting keys/values of local and remote registries.  |  ![](https://img.shields.io/github/stars/lpBunny/bof-registry)   | ![](https://img.shields.io/github/languages/top/lpBunny/bof-registry)     |
|  Auxiliary   |   [InlineExecute-Assembly](https://github.com/anthemtotheego/InlineExecute-Assembly)  | InlineExecute-Assembly is a proof of concept Beacon Object File (BOF) that allows security professionals to perform in process .NET assembly execution as an alternative to Cobalt Strikes traditional fork and run execute-assembly module  |  ![](https://img.shields.io/github/stars/anthemtotheego/InlineExecute-Assembly)   | ![](https://img.shields.io/github/languages/top/anthemtotheego/InlineExecute-Assembly)     |
|  Auxiliary   |   [CredBandit](https://github.com/xforcered/CredBandit)  |   CredBandit is a proof of concept Beacon Object File (BOF) that uses static x64 syscalls to perform a complete in memory dump of a process and send that back through your already existing Beacon communication channel. The memory dump is done by using NTFS transactions which allows us to write the dump to memory and the MiniDumpWriteDump API has been replaced with an adaptation of ReactOS's implementation of MiniDumpWriteDump.  |  ![](https://img.shields.io/github/stars/xforcered/CredBandit)   | ![](https://img.shields.io/github/languages/top/xforcered/CredBandit)     |
|  Auxiliary   | [Inject AMSI Bypass](https://github.com/boku7/injectAmsiBypass)  | Cobalt Strike Beacon Object File (BOF) that bypasses AMSI in a remote process with code injection.  |  ![](https://img.shields.io/github/stars/boku7/injectAmsiBypass)   | ![](https://img.shields.io/github/languages/top/boku7/injectAmsiBypass)     |
|  Auxiliary   | [Firewall_Enumerator_BOF](https://github.com/EspressoCake/Firewall_Walker_BOF)  | Cobalt Strike Beacon Object File (BOF) that bypasses AMSI in a remote process with code injection.  |  ![](https://img.shields.io/github/stars/EspressoCake/Firewall_Walker_BOF)   | ![](https://img.shields.io/github/languages/top/EspressoCake/Firewall_Walker_BOF)     |
|  Auxiliary   | [Detect-Hooks](https://github.com/anthemtotheego/Detect-Hooks)  | Proof of concept Beacon Object File (BOF) that attempts to detect userland hooks in place by AV/EDR  |  ![](https://img.shields.io/github/stars/anthemtotheego/Detect-Hooks)   | ![](https://img.shields.io/github/languages/top/anthemtotheego/Detect-Hooks)     |
|  Auxiliary   | [unhook-bof](https://github.com/rsmudge/unhook-bof)  | Remove API hooks from a Beacon process.  |  ![](https://img.shields.io/github/stars/rsmudge/unhook-bof)   | ![](https://img.shields.io/github/languages/top/rsmudge/unhook-bof)     |
|  Auxiliary   | [whereami](https://github.com/boku7/whereami)  | Cobalt Strike "Where Am I?" Beacon Object File  |  ![](https://img.shields.io/github/stars/boku7/whereami)   | ![](https://img.shields.io/github/languages/top/boku7/whereami)     |
|  Auxiliary   | [BOFs](https://github.com/RiccardoAncarani/BOFs)  | send_shellcode_via_pipe;cat;wts_enum_remote_processes  |  ![](https://img.shields.io/github/stars/RiccardoAncarani/BOFs)   | ![](https://img.shields.io/github/languages/top/RiccardoAncarani/BOFs)     |
|  Auxiliary   | [SCShell](https://github.com/Mr-Un1k0d3r/SCShell)  | SCShell is a fileless lateral movement tool that relies on ChangeServiceConfigA to run commands.  |  ![](https://img.shields.io/github/stars/Mr-Un1k0d3r/SCShell)   | ![](https://img.shields.io/github/languages/top/Mr-Un1k0d3r/SCShell)     |
|  Auxiliary   | [LSASS Dumping With Foreign Handles](https://github.com/alfarom256/BOF-ForeignLsass)  | LSASS Dumping With Foreign Handles  |  ![](https://img.shields.io/github/stars/alfarom256/BOF-ForeignLsass)   | ![](https://img.shields.io/github/languages/top/alfarom256/BOF-ForeignLsass)     |
|  Auxiliary   | [PPLDump BOF](https://github.com/EspressoCake/PPLDump_BOF)  | this is a fully-fledged BOF to dump an arbitrary protected process.(LSASS)  |  ![](https://img.shields.io/github/stars/EspressoCake/PPLDump_BOF)   | ![](https://img.shields.io/github/languages/top/EspressoCake/PPLDump_BOF)     |
|  Auxiliary   | [Process Protection Level Enumerator BOF](https://github.com/EspressoCake/Process_Protection_Level_BOF)  | A Syscall-only BOF file intended to grab process protection attributes, limited to a handful that Red Team operators and pentesters would commonly be interested in.  |  ![](https://img.shields.io/github/stars/EspressoCake/Process_Protection_Level_BOF)   | ![](https://img.shields.io/github/languages/top/EspressoCake/Process_Protection_Level_BOF)     |
|  Auxiliary   | [Toggle_Token_Privileges_BOF](https://github.com/EspressoCake/Toggle_Token_Privileges_BOF)  | AAn (almost) syscall-only BOF file intended to either add or remove token privileges within the context of your current process.  |  ![](https://img.shields.io/github/stars/EspressoCake/Toggle_Token_Privileges_BOF)   | ![](https://img.shields.io/github/languages/top/EspressoCake/Toggle_Token_Privileges_BOF)     |
|  Auxiliary   | [Cobalt Strike BOF - Inject ETW Bypass](https://github.com/boku7/injectEtwBypass)  | Inject ETW Bypass into Remote Process via Syscalls (HellsGate|HalosGate)  |  ![](https://img.shields.io/github/stars/boku7/injectEtwBypass)   | ![](https://img.shields.io/github/languages/top/boku7/injectEtwBypass)     |
|  Exploit   |   [CVE-2020-0796-BOF](https://github.com/rsmudge/CVE-2020-0796-BOF)  |   SMBGhost LPE  |  ![](https://img.shields.io/github/stars/rsmudge/CVE-2020-0796-BOF)   | ![](https://img.shields.io/github/languages/top/rsmudge/CVE-2020-0796-BOF)     |
|  Exploit   |   [ZeroLogon-BOF](https://github.com/rsmudge/ZeroLogon-BOF)  |   ZeroLogon  |  ![](https://img.shields.io/github/stars/rsmudge/ZeroLogon-BOF)   | ![](https://img.shields.io/github/languages/top/rsmudge/ZeroLogon-BOF)     |
|  Persistence   |   [SPAWN](https://github.com/boku7/spawn)  |   Cobalt Strike BOF that spawns a sacrificial process, injects it with shellcode, and executes payload. Built to evade EDR/UserLand hooks by spawning sacrificial process with Arbitrary Code Guard (ACG), BlockDll, and PPID spoofing.  |  ![](https://img.shields.io/github/stars/boku7/spawn)   | ![](https://img.shields.io/github/languages/top/boku7/spawn)    |
|  BypassAV   |   [SigFlip](https://github.com/med0x2e/SigFlip)  |   SigFlip is a tool for patching authenticode signed PE files (exe, dll, sys ..etc) in a way that doesn't affect or break the existing authenticode signature, in other words you can change PE file checksum/hash by embedding data (i.e shellcode) without breaking the file signature, integrity checks or PE file functionality.  |  ![](https://img.shields.io/github/stars/med0x2e/SigFlip)   | ![](https://img.shields.io/github/languages/top/med0x2e/SigFlip)    |

### 免责声明
本项目代码仅能在取得足够合法授权的企业安全建设中使用，在使用本项目过程中，您应确保自己所有行为符合当地的法律法规。 如您在使用本项目的过程中存在任何非法行为，您将自行承担所有后果，本项目所有开发者和所有贡献者不承担任何法律及连带责任。 除非您已充分阅读、完全理解并接受本协议所有条款，否则，请您不要安装并使用本项目。 您的使用行为或者您以其他任何明示或者默示方式表示接受本协议的，即视为您已阅读并同意本协议的约束。
